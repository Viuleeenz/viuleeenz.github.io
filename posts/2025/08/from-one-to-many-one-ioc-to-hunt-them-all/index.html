<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="If you are a threat researcher reading a blog post about a novel threat that could potentially impact your organization, or if you need to investigate this threat to enrich your internal telemetry for better tracking and detection, how would you proceed?
This was the question that come up in my mind, out of the blue, reading an article from Unit42 where they start to talk about a novel malware sold in the underground named Gremlin stealer. As always the article is very well detailed, carefully explaining the malware’s characteristics and objectives while also providing the SHA-256 hash of the analyzed sample.
"><meta name=keywords content="malware,binary,digital forensics,exploit development,reverse engineering"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://Viuleeenz.github.io/posts/2025/08/from-one-to-many-one-ioc-to-hunt-them-all/><title>From one to many - one IOC to hunt them ALL :: Security Undisguised
</title><link rel=stylesheet href=../../../../scss/main.c2f26a20d135ff7bc7091bb95e626c68bc9d8e4c0852d733dbfe9527448dfa92.css integrity="sha256-wvJqINE1/3vHCRu5XmJsaLydjkwIUtcz2/6VJ0SN+pI="><link rel=stylesheet type=text/css href=../../../../style.css><link rel=apple-touch-icon sizes=180x180 href=../../../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../../../favicon-16x16.png><link rel=manifest href=../../../../site.webmanifest><link rel=mask-icon href=../../../../safari-pinned-tab.svg color><link rel="shortcut icon" href=../../../../favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="From one to many - one IOC to hunt them ALL"><meta itemprop=description content="If you are a threat researcher reading a blog post about a novel threat that could potentially impact your organization, or if you need to investigate this threat to enrich your internal telemetry for better tracking and detection, how would you proceed?
This was the question that come up in my mind, out of the blue, reading an article from Unit42 where they start to talk about a novel malware sold in the underground named Gremlin stealer. As always the article is very well detailed, carefully explaining the malware’s characteristics and objectives while also providing the SHA-256 hash of the analyzed sample."><meta itemprop=datePublished content="2025-08-28T00:00:00+00:00"><meta itemprop=dateModified content="2025-08-28T00:00:00+00:00"><meta itemprop=wordCount content="2863"><meta itemprop=image content="https://Viuleeenz.github.io/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://Viuleeenz.github.io/"><meta name=twitter:title content="From one to many - one IOC to hunt them ALL"><meta name=twitter:description content="If you are a threat researcher reading a blog post about a novel threat that could potentially impact your organization, or if you need to investigate this threat to enrich your internal telemetry for better tracking and detection, how would you proceed?
This was the question that come up in my mind, out of the blue, reading an article from Unit42 where they start to talk about a novel malware sold in the underground named Gremlin stealer. As always the article is very well detailed, carefully explaining the malware’s characteristics and objectives while also providing the SHA-256 hash of the analyzed sample."><meta property="og:url" content="https://Viuleeenz.github.io/posts/2025/08/from-one-to-many-one-ioc-to-hunt-them-all/"><meta property="og:site_name" content="Security Undisguised"><meta property="og:title" content="From one to many - one IOC to hunt them ALL"><meta property="og:description" content="If you are a threat researcher reading a blog post about a novel threat that could potentially impact your organization, or if you need to investigate this threat to enrich your internal telemetry for better tracking and detection, how would you proceed?
This was the question that come up in my mind, out of the blue, reading an article from Unit42 where they start to talk about a novel malware sold in the underground named Gremlin stealer. As always the article is very well detailed, carefully explaining the malware’s characteristics and objectives while also providing the SHA-256 hash of the analyzed sample."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-28T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-28T00:00:00+00:00"><meta property="og:image" content="https://Viuleeenz.github.io/"><meta property="article:published_time" content="2025-08-28 00:00:00 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=../../../../ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd /home/Viuleeenz</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=../../../../about/>About</a></li><li><a href=../../../../posts/>Posts</a></li><li><a href=../../../../whitepapers/>Whitepapers</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span>
</span></span><script async src="https://www.googletagmanager.com/gtag/js?id=G-XNKLBC4D9D"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XNKLBC4D9D")}</script></header><div class=content><main class=post><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
14 minutes</p></div><article><h1 class=post-title><a href=https://Viuleeenz.github.io/posts/2025/08/from-one-to-many-one-ioc-to-hunt-them-all/>From one to many - one IOC to hunt them ALL</a></h1><div class=post-content><p><em>If you are a threat researcher reading a blog post about a novel threat that could potentially impact your organization, or if you need to investigate this threat to enrich your internal telemetry for better tracking and detection, how would you proceed?</em></p><p>This was the question that come up in my mind, out of the blue, reading an article from Unit42 where they start to talk about a novel malware sold in the underground named <a href=https://unit42.paloaltonetworks.com/new-malware-gremlin-stealer-for-sale-on-telegram/>Gremlin stealer</a>. As always the article is very well detailed, carefully explaining the malware’s characteristics and objectives while also providing the SHA-256 hash of the analyzed sample.</p><p>Generally speaking, shared IOCs are invaluable resources for the security community, as detection capabilities often depend on the breadth of threat intelligence available in your platform. However, IOC collections can vary dramatically in quality and scope. Sometimes you&rsquo;ll find comprehensive lists containing everything from phishing email hashes and malware stages to domains and JavaScript files. Other times, you&rsquo;re left with minimal intelligence—perhaps just a single hash and a brief description—making threat hunting significantly more challenging.</p><blockquote><p>💡<em>When you encounter a new threat and there aren’t many resources to rely on, you must leverage your own internal data to collect additional intelligence. This allows you to extract valuable IOCs, pivot across related malware infrastructures, and discover additional hidden samples.</em></p></blockquote><p>In this blog post, we’ll walk through a <strong>threat-hunting methodology</strong> using <strong>Gremlin Stealer</strong> as our primary case study. We’ll explore how to extract <strong>meaningful intelligence</strong> from a single malware sample — <strong>without heavily relying on reversing activities</strong> — and transform that knowledge into <strong>actionable hunting strategies</strong> capable of detecting broader threat actor operations.</p><h2 id=understanding-sample-relationships>Understanding Sample Relationships</h2><p>Effective threat hunting begins with understanding how malware samples relate to each other. <strong>Static characteristics</strong> form the foundation of this analysis. File hash relationships are particularly valuable—searching for samples with the same <strong>imphash</strong> (import hash) can reveal binaries that use similar API patterns, while <strong>ssdeep</strong> and other fuzzy hashing techniques help identify files with comparable byte-level structures, even when their exact hashes differ due to minor modifications or repacking.</p><p>In addition to hashes, <strong>file metadata</strong> can provide another valuable layer of similarity indicators, helping connect samples that may belong to the same malware family or campaign. However, similarity analysis shouldn’t stop at static attributes. From a <strong>behavioral standpoint</strong>, distinctive indicators often emerge, such as: <strong>File creation paths, Command-line arguments, Registry modifications, Network communication patterns,</strong> etc..</p><p>When multiple samples shows overlapping behavioral traits — for instance, reaching out to the same C2 infrastructure or using identical file paths — it becomes much easier to <strong>cluster them under the same threat actor’s activity</strong>. In fact, for hunting purposes, <strong>behavioral indicators are often more reliable than static characteristics</strong>, since they reflect what the malware <strong>must</strong> do to achieve its objectives.</p><blockquote><p>💡 <em>Static characteristics are <strong>easily modified</strong> by threat actors, but behavioral requirements are <strong>functionally constrained</strong>. A threat actor can change how malware looks, but it’s much harder to change what it needs to do to succeed.</em></p></blockquote><h3 id=static-indicators>Static Indicators</h3><p>When examining our Gremlin Stealer sample in VirusTotal, several metadata characteristics immediately caught the attention. Each of these anomalies not only serves as a detection opportunity but also provides clues about the malware author&rsquo;s techniques and intentions:</p><ul><li><p><strong>Anomalous Timestamp</strong></p><p>The file’s reported creation date — <strong>2041-06-29 19:48:00 UTC</strong> — is set in the future. This is a <strong>common anti-analysis technique</strong> used by malware authors to bypass certain detection mechanisms or confuse automated analysis pipelines.</p></li><li><p><strong>Misleading Copyright Information</strong></p><blockquote><p>“LLC &lsquo;Windows&rsquo; & Copyright © 2024”</p><p>While it attempts to <strong>mimic legitimate Microsoft software</strong>, the naming convention is <strong>incorrect</strong>.</p></blockquote></li><li><p><strong>.NET Assembly Metadata</strong></p><p>Since <strong>Gremlin Stealer</strong> is a <strong>.NET binary</strong>, it exposes rich metadata that can be extremely useful for clustering related samples. Notably:</p><ul><li><strong>Module Version ID (MVID):</strong> <code>8f855bb2-4718-4fa4-be9c-87ed0b588b5c</code></li><li><strong>TypeLib ID:</strong> <code>7c11697d-caad-4bae-8b2a-0e331680a53b</code></li></ul><p>These identifiers are <strong>generated during compilation</strong> and often remain <strong>consistent across samples built from the same source code or development environment</strong>. As such, they can be powerful static indicators for <strong>connecting related binaries</strong> within the same malware family</p></li></ul><p><img src=../../../../img/threat_hunt/gremlin_info.png alt="Figure 1: Gremlin Stealer Information"></p><p>Figure 1: Gremlin Stealer Information</p><h3 id=behavioral-indicators>Behavioral indicators</h3><p>While static analysis provides valuable initial insights, behavioral analysis through sandbox execution reveals how the malware actually operates in a live environment. VirusTotal&rsquo;s sandbox capabilities allow us to observe Gremlin Stealer&rsquo;s runtime behavior, uncovering network communications, file system interactions, and process execution patterns that static analysis alone cannot reveal.</p><p><img src=../../../../img/threat_hunt/gremlin_urls.png alt="Figure 2: Gremlin Stealer URLs"></p><p>Figure 2: Gremlin Stealer URLs</p><p>Gremlin Stealer’s <strong>behavior tab</strong> reveals distinct networking fingerprints:</p><ul><li><p><strong>IP Discovery Services</strong> → The malware reaches out to:</p><ul><li><code>api.ipify.org</code></li><li><code>ip-api.com</code></li></ul><p>These requests are used to <strong>determine the victim’s external IP address</strong>, a common tactic among info-stealers for <strong>geolocation</strong> and <strong>target profiling</strong>.</p></li><li><p><strong>Telegram API Endpoints</strong> → Connections to <code>api.telegram.org/bot</code> strongly suggest that <strong>Telegram is used for data exfiltration</strong>.</p><ul><li>This technique has become increasingly <strong>popular among cybercriminals</strong> due to <strong>encryption</strong>, <strong>ease of automation</strong>, and <strong>resilience against takedowns</strong>.</li></ul></li><li><p><strong>Hardcoded C2 Server</strong> → <code>207.244.199[.]46</code> is embedded as a <strong>command-and-control endpoint</strong>.</p><ul><li>This serves as both an <strong>immediate IOC</strong> and a <strong>pivot point</strong> for uncovering related infrastructure used by the same threat actor.</li></ul></li></ul><p>Moreover, digging deeper into the <strong>behavior tab</strong> reveals how Gremlin Stealer systematically <strong>harvests sensitive data</strong> from multiple browsers, including <strong>Chrome</strong>, <strong>Brave</strong>, <strong>Edge</strong>, and other Chromium-based derivatives. One particularly interesting technique involves launching browser instances with <strong>remote debugging enabled.</strong></p><p><img src=../../../../img/threat_hunt/behvaioral_info.png alt="Figure 3: VirusTotal behvaior tab for Gremlin Stealer sample"></p><p>Figure 3: VirusTotal behvaior tab for Gremlin Stealer sample</p><blockquote><p>💡 <em>There is <strong>no single indicator</strong> you can always rely on. Threat hunting success depends on <strong>how much information you can extract</strong> from a sample and how effectively you <strong>correlate it with other intelligence</strong>. This process requires <strong>iterative analysis</strong> and cannot be treated as a one-time or “spot” activity.</em></p></blockquote><h3 id=exploring-vt-queries-to-collect-more-samples>Exploring VT Queries to collect more samples</h3><p>Crafting effective VirusTotal hunting queries is both an art and a science. The challenge lies in balancing precision with coverage—queries that are too narrow will miss related variants, while overly broad searches generate overwhelming false positives. The sweet spot lies in identifying characteristics that are:</p><ul><li><strong>Likely to remain consistent</strong> across the threat actor’s campaigns</li><li><strong>Unique enough</strong> to minimize noise during collection</li></ul><p>Using the intelligence we’ve gathered so far from our Gremlin Stealer sample, we can start sketching out a <strong>VirusTotal hunting query</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>generated:</span><span style=color:#e6db74>&#34;2041-06-29T19:48:00&#34;</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>signature:</span><span style=color:#e6db74>&#34;LLC &#39;Windows&#39; &amp; Copyright ©  2024&#34;</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>netguid:</span><span style=color:#ae81ff>8</span><span style=color:#960050;background-color:#1e0010>f</span><span style=color:#ae81ff>855</span><span style=color:#960050;background-color:#1e0010>bb</span><span style=color:#ae81ff>2-4718-4</span><span style=color:#960050;background-color:#1e0010>fa</span><span style=color:#ae81ff>4</span><span style=color:#960050;background-color:#1e0010>-be</span><span style=color:#ae81ff>9</span><span style=color:#960050;background-color:#1e0010>c</span><span style=color:#ae81ff>-87</span><span style=color:#960050;background-color:#1e0010>ed</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>b</span><span style=color:#ae81ff>588</span><span style=color:#960050;background-color:#1e0010>b</span><span style=color:#ae81ff>5</span><span style=color:#960050;background-color:#1e0010>c</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>behavior:</span><span style=color:#e6db74>&#34;\&#34;%ProgramFiles(x86)%\\Google\\Chrome\\Application\\chrome.exe\&#34; --restore-last-session --remote-debugging-port=9222 --user-data-dir=\&#34;%LOCALAPPDATA%\\Google\\Chrome\\User Data\&#34;&#34;</span>
</span></span></code></pre></div><p>Starting with the first one (<em>generated:&ldquo;2041-06-29T19:48:00&rdquo;</em>) ****we are able to collect a couple of samples.</p><p><img src=../../../../img/threat_hunt/vt_simple.png alt="Figure 4: Potentially correlated sample with original Gremlin Stealer"></p><p>Figure 4: Potentially correlated sample with original Gremlin Stealer</p><p>As expected, the first match is <strong>our original sample</strong>. However, the second one appears to be <strong>a new potential candidate</strong> worth investigating based on its <strong>filename</strong> and metadata, which suggest it may be linked to the same campaign.</p><p>To validate this assumption, we need to <strong>cross-check indicators</strong> between our original sample and the new binary. Diving into the <strong>details</strong> and <strong>behavior tabs</strong> reveals strong overlaps:</p><ul><li>Matching <strong>signature strings</strong></li><li>Identical <strong>LegalTradeMark</strong> values</li><li>Same <strong>.NET Module Version ID (MVID)</strong></li><li>Same <strong>TypeVersion</strong> metadata</li></ul><p>Additionally, inspecting the <strong>functions list</strong> and <strong>external modules</strong> shows <strong>identical APIs and libraries</strong> in both binaries, suggesting a <strong>shared codebase</strong>.</p><blockquote><p>💡 <em>At this stage, you might feel like a single new sample isn’t enough — but resist the temptation to cast a wider net too early. Every hash you collect must be <strong>validated</strong> to ensure it’s truly related. Once you confirm multiple samples with strong correlations, you can safely expand your query and begin crafting <strong>high-confidence detection rules</strong>.</em></p></blockquote><h3 id=comparing-disassembled-code>Comparing Disassembled Code</h3><p>Sometimes, <strong>metadata alone isn’t enough</strong> to confidently determine whether two samples are related. In these cases, a deeper dive into the <strong>disassembled code</strong> can provide stronger evidence. By analyzing the code structure, <strong>function names</strong>, and <strong>implementation patterns</strong>, we can often spot significant overlaps that confirm a shared origin. In our case, we can clearly see that the two samples:</p><ul><li>Share a <strong>large number of identical functions</strong></li><li>Use the <strong>same function names</strong></li><li>Contain <strong>matching code blocks</strong> within those functions</li></ul><p>This level of similarity strongly suggests that both binaries were compiled from the <strong>same source code</strong> or at least from <strong>closely related codebases</strong>.</p><p><img src=../../../../img/threat_hunt/disass_code.png alt="Figure 5: Gremlin Stealer code"></p><p>Figure 5: Gremlin Stealer code</p><blockquote><p>💡 <em>For C/C++-like binaries, a highly effective workflow is to combine <strong>IDA Pro</strong> for performing an <strong>in-depth analysis</strong> of one binary, and then leverage <strong>BinDiff</strong> to compare it against another. This highlights <strong>code-level similarities and discrepancies</strong>, making it easier to identify relationships and validate correlations between samples.</em></p></blockquote><h3 id=analyzing-additional-result-information>Analyzing additional result information</h3><p>After completing the investigation on the previously identified sample, we can continue our research using the same <strong>hunting methodology</strong>, but this time pivoting on other <strong>high-confidence indicators</strong> such as the <strong>signature</strong> and the <strong>netguid</strong> we collected earlier. When we pivot on the <strong>signature</strong>, VirusTotal returns <strong>15 matches</strong>. On the other hand, pivoting on the <strong>netguid</strong> produces <strong>13 matches</strong>. This discrepancy raises important questions that can fuel further investigation. Some of these questions directly influence <strong>tactical hunting</strong>, while others provide paths toward <strong>strategic intelligence</strong>.</p><p><img src=../../../../img/threat_hunt/signature_and_netguid.png alt="Figure 6: VT Queries results for signature and netguid tags."></p><p>Figure 6: VT Queries results for signature and netguid tags.</p><p>Differences in the returned results could indicate the presence of <strong>.NET build outliers</strong> that deviate slightly from the main family. To better understand them, we can:</p><ul><li>Investigate whether these <strong>outlier samples</strong> show <strong>different behavioral patterns</strong></li><li>Determine why these specific builds were created — e.g., testing variants, specialized targets, or toolchain updates</li><li>Analyze whether these binaries communicate with <strong>different infrastructures</strong> or reuse existing ones</li></ul><p>These insights can directly enhance detection engineering and improve coverage for <strong>variant-level hunting</strong>. Beyond tactical detection, the results open the door to deeper <strong>strategic intelligence</strong> questions:</p><ul><li>How <strong>large</strong> is the organization behind Gremlin Stealer?</li><li>Do the different build lines suggest the involvement of <strong>multiple threat actors</strong> or a <strong>single actor with multiple operational capabilities</strong>?</li><li>Could these variations indicate <strong>distinct campaigns</strong> tailored for specific geographies, targets, or objectives?</li></ul><p>Answering these questions requires a broader analysis of development patterns, campaign overlaps, and infrastructure reuse — insights that are valuable for <strong>long-term threat actor profiling</strong>.</p><blockquote><p>💡 <em>Attribution remains one of the most challenging aspects of threat intelligence. Unlike traditional forensics, where physical evidence provides concrete links, <strong>cyber attribution</strong> often relies on connecting <strong>digital breadcrumbs</strong> across fragmented datasets. Accurate attribution typically involves multiple steps, including <strong>code similarity analysis</strong>, <strong>infrastructure tracking</strong>, <strong>campaign clustering</strong>, and even <strong>business model assessments</strong> — all of which contribute to building a robust <strong>threat actor profile</strong>.</em></p></blockquote><h3 id=writing-yara-rules>Writing Yara Rules</h3><p>With our comprehensive intelligence gathering complete, we can now translate our findings into actionable detection logic. Creating a YARA rule allows us to codify the patterns we&rsquo;ve discovered, enabling automated detection across security platforms. Our rule needs to balance several competing priorities: broad enough to catch variants, specific enough to minimize false positives, and resilient enough to survive minor modifications by threat actors.</p><p>When analyzing the <strong>15 matching samples</strong>, it’s clear that some binaries contain <strong>obfuscated code</strong>, which makes relying solely on <strong>assembly instructions</strong> less effective. Instead, we’ll focus on <strong>unique strings</strong> and <strong>metadata-based attributes</strong> extracted during our VirusTotal analysis.</p><p>Here’s an <strong>initial draft</strong> of the rule:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>rule</span> <span style=color:#960050;background-color:#1e0010>GermlinStealer</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>meta:</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>description</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#f92672>&#34;Detects Gremlin Stealer&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>author</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;Viuleeenz&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>date</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;2025-08-25&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>hash</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;d1ea7576611623c6a4ad1990ffed562e8981a3aa209717065eddc5be37a76132&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>reference</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;https://unit42.paloaltonetworks.com/new-malware-gremlin-stealer-for-sale-on-telegram/&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>strings</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Fraudulent copyright and version information
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#960050;background-color:#1e0010>$metadata</span><span style=color:#ae81ff>1</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;LLC &#39;Windows&#39; &amp; Copyright&#34;</span> <span style=color:#960050;background-color:#1e0010>ascii</span> <span style=color:#960050;background-color:#1e0010>wide</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>$metadata</span><span style=color:#ae81ff>2</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;CefSharp.BrowsersSubprocess&#34;</span> <span style=color:#960050;background-color:#1e0010>ascii</span> <span style=color:#960050;background-color:#1e0010>wide</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>$metadata</span><span style=color:#ae81ff>3</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;CefSharp&#34;</span> <span style=color:#960050;background-color:#1e0010>ascii</span> <span style=color:#960050;background-color:#1e0010>wide</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// .NET details
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#960050;background-color:#1e0010>$typelib_id</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;7c11697d-caad-4bae-8b2a-0e331680a53b&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>$module_version_id</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;8f855bb2-4718-4fa4-be9c-87ed0b588b5c&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Cryptocurrency wallet targeting
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//$crypto1 = &#34;bitcoincore&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//$crypto2 = &#34;litecoincore&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//$crypto3 = &#34;electrum&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//$crypto4 = &#34;exodus&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//$crypto5 = &#34;atomicwallet&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//$crypto6 = &#34;monero&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>$library</span><span style=color:#ae81ff>1</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;bcrypt.dll&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>$library</span><span style=color:#ae81ff>2</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;dllFilePath&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>$library</span><span style=color:#ae81ff>3</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;iphlpapi.dll&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>$library</span><span style=color:#ae81ff>4</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;kernel32.dll&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>$library</span><span style=color:#ae81ff>5</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;user32.dll&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>condition</span>:
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>uint</span><span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>(</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#960050;background-color:#1e0010>==</span> <span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>x</span><span style=color:#ae81ff>5</span><span style=color:#960050;background-color:#1e0010>a</span><span style=color:#ae81ff>4</span><span style=color:#960050;background-color:#1e0010>d</span> <span style=color:#960050;background-color:#1e0010>and</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>filesize</span> <span style=color:#960050;background-color:#1e0010>&lt;</span> <span style=color:#ae81ff>500</span><span style=color:#960050;background-color:#1e0010>KB</span> <span style=color:#960050;background-color:#1e0010>and</span> 
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>(any</span> <span style=color:#960050;background-color:#1e0010>of</span> <span style=color:#960050;background-color:#1e0010>($metadata*))</span> <span style=color:#960050;background-color:#1e0010>and</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>(($typelib_id)</span> <span style=color:#960050;background-color:#1e0010>or</span> <span style=color:#960050;background-color:#1e0010>($module_version_id))</span> <span style=color:#960050;background-color:#1e0010>and</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>(</span><span style=color:#ae81ff>3</span> <span style=color:#960050;background-color:#1e0010>of</span> <span style=color:#960050;background-color:#1e0010>($library*))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This rule focuses on <strong>three key detection pillars</strong>:</p><ol><li><strong>Metadata & Branding Strings</strong><ul><li>Fake copyright claims and Chromium subprocess references</li><li>Helps detect samples attempting to <strong>masquerade as legitimate Microsoft software</strong></li></ul></li><li><strong>.NET Compilation Identifiers</strong><ul><li>Uses <code>TypeLib ID</code> and <code>Module Version ID</code> for clustering</li><li>Very strong, but can be <strong>overly restrictive</strong> if the malware author recompiles</li></ul></li><li><strong>Functional Capabilities</strong><ul><li>Matches keywords related to <strong>crypto wallet theft</strong></li><li>Includes critical <strong>Windows DLLs</strong> commonly referenced by Gremlin Stealer</li></ul></li></ol><p><img src=../../../../img/threat_hunt/yara.png alt="Figure 7: Yara results"></p><p>Figure 7: Yara results</p><blockquote><p>💡 <em>There isn’t a <strong>single YARA rule</strong> that works for every scenario. Even this rule isn’t perfect. It relies on <strong>crypto-related strings</strong>, which could affect detection efficiency in certain environments. However, this rule was designed as an <strong>experimental approach</strong> to validate its effectiveness, so testing it made sense. Similarly, the use of <strong>.NET-specific identifiers</strong> might be a bit <strong>restrictive</strong>, potentially missing variants compiled with different settings. Ultimately, the <strong>best rule design</strong> depends on your goals and the <strong>system ingesting the files</strong>. In some cases, you may want a <strong>highly tailored, precise rule</strong> that minimizes false positives; in others, a <strong>broader rule</strong> with a higher tolerance for noise might be more appropriate. The key is balancing <strong>coverage and accuracy</strong> based on your operational needs.</em></p></blockquote><h3 id=collecting-infrastructural-information>Collecting Infrastructural Information</h3><p>Our malware analysis has yielded valuable insights, but the investigation remains incomplete without understanding the infrastructure supporting Gremlin Stealer&rsquo;s operations. Threat actors don&rsquo;t operate in isolation—they require command and control servers, data exfiltration channels, and often administrative panels to manage their campaigns. By mapping this infrastructure, we can uncover additional IOCs and gain deeper insight into the scope of their operations.</p><p>Starting from the previously identified IP address <strong>207.244.199[.]46</strong>, we can leverage tools like <a href=https://urlscan.io/>Urlscan</a> and <a href=https://app.validin.com/login>Validin</a> to expand our research. By querying this IP, we immediately uncover <strong>interesting insights</strong>, including a glimpse of what appears to be the <strong>Gremlin control panel</strong>.</p><p><img src=../../../../img/threat_hunt/gremlin_infra.png alt="Figure 8: Gremlin Stealer Control Panel"></p><p>Figure 8: Gremlin Stealer Control Panel</p><p>Digging deeper, we can extract the <strong>HTML source code</strong>, <strong>DOM structure</strong>, and <strong>associated assets,</strong> including images and icons, from the landing page. By <strong>computing hashes</strong> of these elements, we create new <strong>pivot points</strong> that can be used to identify <strong>related infrastructure</strong> and potential additional panels.</p><p>At this stage, we’ve already collected:</p><ul><li>The <strong>landing page content</strong> and <strong>visual assets</strong></li><li>The <strong>DOM hash</strong> and other unique fingerprints</li><li>Metadata such as <strong>page title</strong> and associated <strong>icon hashes</strong></li></ul><p>Using these artifacts, we can pivot further using <strong>Validin</strong>. Starting with the same IP, we uncover additional details such as the <strong>host title</strong> used by the panel. This information becomes valuable because we can search for the same title across other servers, potentially revealing <strong>related panels</strong> deployed on <strong>different IPs</strong>.</p><p><img src=../../../../img/threat_hunt/correlated_ips.png alt="Figure 9: Additionally Control Panel IPs"></p><p>Figure 9: Additionally Control Panel IPs</p><p>Interestingly, the same <strong>host title</strong> is seen on <strong>multiple IP addresses</strong>. This is an important discovery:</p><ul><li>It <strong>suggests a broader infrastructure</strong> behind Gremlin Stealer.</li><li>It gives us <strong>new candidate servers</strong> to investigate.</li><li>Some of these IPs might still <strong>host active panels</strong>, providing opportunities for <strong>deeper intelligence gathering</strong> 👀.</li></ul><h3 id=sketching-a-threat-actor-profile>Sketching a Threat Actor Profile</h3><p>With the intelligence collected so far (e.g., <strong>malware samples, behavioral patterns, and infrastructure insights</strong>), it is possible to begin sketching a preliminary <strong>threat actor profile</strong>. By correlating static indicators like <strong>.NET identifiers and metadata</strong>, behavioral traits such as <strong>browser targeting and command-line arguments</strong>, and infrastructural data including <strong>C2 IPs and panel hostnames</strong>, we can start to infer the operational capabilities and methods of the actor behind Gremlin Stealer.</p><p>This profile helps answer key questions:</p><ul><li><strong>Scope and scale:</strong> How many campaigns or variants are likely active?</li><li><strong>Technical sophistication:</strong> Which coding practices, obfuscation techniques, and exfiltration methods are employed?</li><li><strong>Operational patterns:</strong> Do multiple IPs, host titles, or panel infrastructures suggest a centralized organization or distributed teams?</li><li><strong>Targeting focus:</strong> Are specific industries or regions being prioritized?</li></ul><p>While attribution remains challenging, building a structured profile allows analysts to <strong>prioritize investigations, anticipate next moves, and design more effective detection rules</strong>. Over time, as new samples and infrastructure emerge, this profile can be refined into a <strong>comprehensive understanding of the threat actor’s TTPs, infrastructure, and strategic objectives</strong>.</p><p><img src=../../../../img/threat_hunt/ta_sketch.png alt="Figure 10: Attempt of Gremlin Stealer sketching profile"></p><p>Figure 10: Attempt of Gremlin Stealer sketching profile</p><h3 id=conclusion>Conclusion</h3><p>Remember the question we started with: <em>&ldquo;If you are a threat researcher reading a blog post about a novel threat that could potentially impact your organization, or if you need to investigate this threat to enrich your internal telemetry for better tracking and detection, how would you proceed?&rdquo;</em></p><p>Through our Gremlin Stealer investigation, we&rsquo;ve demonstrated that the answer isn&rsquo;t as daunting as it might initially seem. <strong>You don&rsquo;t need to be a reverse engineering expert to extract meaningful intelligence from a single malware sample.</strong></p><p>Starting with just one hash from Unit42&rsquo;s report, we systematically built a comprehensive threat profile. The key insight? <strong>Effective threat hunting is more about methodology than advanced technical skills.</strong> It&rsquo;s about asking the right questions, knowing where to look for answers, and systematically connecting the dots between seemingly unrelated pieces of information.</p><p>Every indicator we discovered became a stepping stone to the next discovery. This iterative approach transformed a single IoC into a robust detection strategy capable of identifying an entire malware family and its supporting infrastructure.</p><p>So the next time you encounter a novel threat with limited public intelligence, don&rsquo;t be intimidated. <strong>Start with what you have, apply systematic thinking, and let curiosity guide your investigation.</strong> The tools and techniques demonstrated here are accessible to any security professional willing to invest the time to learn them. After all, threat hunting isn&rsquo;t just about finding malware, it&rsquo;s about understanding the adversary. And that understanding begins with a single question and the determination to find the answer.</p><p>Happy hunting! 🔍</p><h3 id=iocs>IOCs</h3><ul><li><p>Potential Control Panel IPs:</p><ul><li>138.124.60[.]33</li><li>217.119.129[.]92</li><li>207.244.199[.]46</li><li>159.65.7[.]52</li></ul></li><li><p>Additonal Gremlin Stealer</p><table><thead><tr><th>Gremlin Stealer - Sha256</th></tr></thead><tbody><tr><td>d1ea7576611623c6a4ad1990ffed562e8981a3aa209717065eddc5be37a76132</td></tr><tr><td>32d081039285eed1fb97dc814da1a97dac9d6efcf5827326067ca0ba2130de05</td></tr><tr><td>971198ff86aeb42739ba9381923d0bc6f847a91553ec57ea6bae5becf80f8759</td></tr><tr><td>598ba6b9bdb9dcc819e92c10d072ce93c464deaa0a136c4a097eb706ef60d527</td></tr><tr><td>01dc8667fd315640abf59efaabb174ac48554163aa1a21778f85b31d4b65c849</td></tr><tr><td>7458cb50adfcce50931665eae6bd9ce81324bc0b70693e550e861574cb0eb365</td></tr><tr><td>208ecca5991d25cc80e4349ce16c9d5a467b10dedcb81c819b6bc28901833ea9</td></tr><tr><td>7ed4eea56c2c96679447cc7dfc8c4918f4f7be2b7ba631bc468e8a180414825a</td></tr><tr><td>8202ba2d361e6507335a65ccc250e01c2769ed22429e25d08d096cd46a6619ff</td></tr><tr><td>281b970f281dbea3c0e8cfc68b2e9939b253e5d3de52265b454d8f0f578768a2</td></tr><tr><td>a9f529a5cbc1f3ee80f785b22e0c472953e6cb226952218aecc7ab07ca328abd</td></tr><tr><td>9aab30a3190301016c79f8a7f8edf45ec088ceecad39926cfcf3418145f3d614</td></tr><tr><td>ab0fa760bd037a95c4dee431e649e0db860f7cdad6428895b9a399b6991bf3cd</td></tr><tr><td>d11938f14499de03d6a02b5e158782afd903460576e9227e0a15d960a2e9c02c</td></tr><tr><td>691896c7be87e47f3e9ae914d76caaf026aaad0a1034e9f396c2354245215dc3</td></tr></tbody></table></li></ul></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
2863 Words</p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2025-08-28 02:00</p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2025</span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span></div></div></footer></div><script type=text/javascript src=../../../../bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc+cxaJzDdCYbAW0X1G+DgZYvtKFXe6MBex8jUJ2JT25mQx+YjACIng=="></script></body></html>